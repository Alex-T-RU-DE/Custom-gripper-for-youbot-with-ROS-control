# Кастомный захват Kuka Youbot с поддержкой ROS
Language: [English](https://github.com/Alex-T-RU-DE/Custom-gripper-for-youbot-with-ROS-control/blob/main/README.md), [Русский](https://github.com/Alex-T-RU-DE/Custom-gripper-for-youbot-with-ROS-control/blob/main/README.ru.md) 

Этот проект описывает как сделать и интегрировать новый захват котролируемый ROSом для Kuka youbot.

## Необходимые компоненты


- Два сервопривода
- Распечатанный на 3D принтере и собраный захват. Модели и информацию можно найти [здесь](https://www.thingiverse.com/thing:4764063).
- Arduino mega/[pro](https://www.amazon.de/ARCELI-Arduino-Mega-ATmega2560-CH340G-Elektronik/dp/B07MQ1J9MR/ref=sr_1_13?dchild=1&keywords=arduino+pro&qid=1613692717&sr=8-13)
- Провода
- [Трансформаторы напряжения](https://www.amazon.de/LAOMAO-Wandler-einstellbar-Spannungswandler-Converter/dp/B00HV4EPG8/ref=asc_df_B00HV4EPG8/?tag=googshopde-21&linkCode=df0&hvadid=231941675984&hvpos=&hvnetw=g&hvrand=3852759402861473550&hvpone=&hvptwo=&hvqmt=&hvdev=c&hvdvcmdl=&hvlocint=&hvlocphy=9068552&hvtargid=pla-420005320986&psc=1&th=1&psc=1)


## Шаг за шагом для запуска программы:

Перед тем как начать, вам необходимо установить Arduino IDE.

1. Копируйте "youbot_gripper" в вашу папку catkin_ws/src.

2. Откройте ваш catking_ws и выполните компиляцию "Youbot gripper" с помощью catkin_make.

3. Установите пакет ROSserial:
 ```
sudo apt-get install ros-<your_ros_version>-rosserial-arduino
sudo apt-get install ros-<your_ros_version>-rosserial
 ```
4. откройте <расположение вашей папки Arduino>/Arduino/library в терминале и выполните следующую команду:
```
rosrun rosserial_arduino make_libraries.py .
```
Эта команда автоматически конвертирует и копирует все ваши новые ROS-сообщения, сервисы и пакеты (включая пакет Youbot gripper) в библиотеки Arduino.

5. Загрузите файл "Gripper_service_server.ino" и расположите его в вашей папке Arduino.

6. Сначала попробуйте выполнить компиляцию программы без ее загрузки. Если она сработала - загрузите программу в плату Arduino и переходите к шагу 7. Если вы получаете следующую ошибку:

```
#include <cstring>
    ^~~~~~~~~
compilation terminated. 
 ```
то вы должны сменить файл "**msg.h**" в вашей директории `~/Arduino/libraries/ros_lib/ros2`, которая была сгенерирована командой ```rosrun rosserial_arduino make_libraries.py .``` , файлом "**msg.h**" который нужно загрузить через `скетч>подключить библиотеку>управлять библиотеками` где вам необходимо через поиск найти библиотеку 
you should change the "**msg.h**" in `~/Arduino/libraries/ros_lib/ros` destination generated by ```rosrun rosserial_arduino make_libraries.py .``` with "**msg.h**" file from "*rosserial lib*" (0.7.8 version) which could be downloaded from the Library manager of Arduino IDE (directory of this file in downloaded library: `~/Rosserial_Arduino_Library/src/ros/`).  

   
7. To start your gipper, you should you following command on your device, which is connected to the gripper:
```
rosrun rosserial_python serial_node.py /dev/tty_YOUR_PORT_FOR_ARDUINO 
```
example:  
```
rosrun rosserial_python serial_node.py /dev/ttyUSB0
```
This command will start the server on your Arduino device, and it will share the service for gripping. You could play with this service by starting a simple client with the following command:
```
rosrun youbot_gripper youbot_gripper_client NUMBER_OF_INSTRUCTIONS 
```
Where ```NUMBER_OF_INSTRUCTIONS``` should be replaced according to numbers, which listed below
        
                                 
## Instructions for the service

To use different commands for this gripper, you could use the following numbers to achieve the desired result:

```0``` - close gripper

```1``` - open gripper

```2-100``` - open gripper for received percent

```1000-1380``` set the angle of the first servo to the position in range 0-380

```2000-2380``` set the angle of the second servo to the position in range 0-380
